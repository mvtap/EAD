---
title: "R Notebook"
output: html_notebook
---

```{r}
data = read.csv("/home/miguel/Documents/Git/EAD/whi-2019.csv")
```

```{r}
data_work = data[-c(1,2)]
```

```{r}
pairs(data_work)
```

```{r}
scaled.data <- scale(data_work)
```

```{r}
fviz_nbclust(scaled.data, FUNcluster = kmeans, method = c("wss"))
```


```{r}
set.seed(123)
km.res <- kmeans(scaled.data, 3, iter.max = 10, nstart = 50)
print(km.res)
```
```{r}
aggregate(data_work, by=list(cluster=km.res$cluster), mean)
```

```{r}
dd <- cbind(data, cluster = km.res$cluster)
head(dd)
```

```{r}
km.res$size
```

```{r}
km.res$centers
```
```{r}
df <- cbind(scaled.data, cluster = km.res$cluster)
rownames(df) <- data$Country.or.region
head(df)
```



```{r fig.height = 15, fig.width = 15}

fviz_cluster(km.res, data = df, labelsize = 12, show.clust.cent = FALSE, repel = TRUE)
```

